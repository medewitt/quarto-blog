---
title: "Bland Altman Plots"
description: |
  whatcha writing about? 
date: 2022-06-05
categories:  [Bayes, Covid-19, Clinical Trials, Stan, Causal Inference]
---

Let's make some fake data:

```{r}
SIGMA <- diag(2)

SIGMA[1,2] <- SIGMA[2,1] <- .3

SIGMA

z <- MASS::mvrnorm(n = 100, mu = c(1,1), Sigma = SIGMA)

```

```{r}
plot(z, bty = "l", las = 1,  cex.axis = 1, 
     ylab = "Measure 2", xlab = "Measure 2")
abline(a = 0,b = 1, lty = 2, col = "blue")
```

Now construct the plot

```{r}
mu_z <- rowMeans(z)
diff_z <- z[,1] - z[,2]
mu_diff <- mean(diff_z)
ba_lower <- mu_diff - 1.96*sd(diff_z)
ba_upper <- mu_diff + 1.96*sd(diff_z)
plot(mu_z, diff_z, pch = 19)
abline(h = ba_lower, col = "red", lty = "dashed")
abline(h = ba_upper, col = "red", lty = "dashed")
```



